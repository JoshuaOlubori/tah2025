-- Theme 3: Product Optimization
-- Question 3: How does product category performance differ across sales channels?
-- This query compares channel revenues side-by-side for each product category.

SELECT
  p.CategoryName,
  FORMAT(SUM(CASE WHEN fs.Channel = 'Online' THEN fs.LineTotal ELSE 0 END), 'C') AS OnlineRevenue,
  FORMAT(SUM(CASE WHEN fs.Channel = 'Reseller' THEN fs.LineTotal ELSE 0 END), 'C') AS ResellerRevenue,
  FORMAT(SUM(fs.LineTotal), 'C') AS TotalRevenue
FROM Analytics.Fact_Sales fs
JOIN Analytics.Dim_Product p ON fs.ProductID = p.ProductID
GROUP BY p.CategoryName
ORDER BY TotalRevenue DESC;

CategoryName,OnlineRevenue,ResellerRevenue,TotalRevenue
Accessories,700759.960000,571312.923926,1272072.883926
Bikes,28318144.650700,66333028.054031,94651172.704731
Clothing,339772.610000,1780769.914801,2120542.524801
Components,0.000000,11802593.286430,11802593.286430
